---
import BaseLayout from './BaseLayout.astro';
const { frontmatter } = Astro.props;

// 1. ÏïàÏ†ÑÏû•Ïπò: frontmatterÍ∞Ä ÏóÜÏùÑ Í≤ΩÏö∞Î•º ÎåÄÎπÑÌï¥ Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
const post = frontmatter || {};
const title = post.title || 'No Title';
const author = post.author || 'Anonymous';
const date = post.date || '2026-01-01';

// 2. Lyket ID ÏÉùÏÑ± (Ï†úÎ™©Ïù¥ ÏóÜÏúºÎ©¥ 'untitled'Î°ú ÏÉùÏÑ±)
const safeTitleId = title.replace(/\s+/g, '-').toLowerCase();
const lyketId = `post-${safeTitleId}`;
---

<BaseLayout title={title}>
  <script is:inline src="https://unpkg.com/@lyket/widget@latest/dist/lyket.js?apiKey=pt_78d53346933065d706596376510343"></script>

  <article class="blog-post">
    <header class="post-header">
      <div class="meta-top">
        <span class="category">{post.category || 'Daily Log'}</span>
        <span class="location">üìç {post.location || 'Earth'}</span>
      </div>
      
      <h1>{title}</h1>
      
      <div class="author-info">
        <span class="author-name">Written by <b>{author}</b></span>
        <span class="post-date">on {date}</span>
      </div>
      
      {post.image && (
        <img src={post.image} alt={title} class="featured-image" />
      )}
      <hr />
    </header>

    <div class="content">
      <slot />
    </div>

    <div class="reaction-zone">
      <h4>How was this signal? (Anonymous)</h4>
      <div class="buttons-wrapper">
        <div 
          data-lyket-type="clap" 
          data-lyket-id={lyketId}
          data-lyket-namespace="blog-claps"
          data-lyket-color-primary="#e74c3c"
          data-lyket-color-text="#e74c3c"
        ></div>
        
        <div 
          style="margin-left: 20px;"
          data-lyket-type="updown" 
          data-lyket-id={lyketId}
          data-lyket-namespace="blog-votes"
          data-lyket-color-primary="#3498db"
          data-lyket-color-background="#f0f2f5"
        ></div>
      </div>
      <p class="reaction-help">‚ñ≤ Click to send a signal to {author}</p>
    </div>
  </article>
</BaseLayout>

<style>
  .blog-post { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
  .post-header { text-align: center; margin-bottom: 2rem; }
  .meta-top { font-size: 0.85rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }
  .location { margin-left: 10px; color: #3498db; }
  h1 { font-size: 2.2rem; margin: 0.5rem 0; color: #2c3e50; line-height: 1.2; }
  .author-info { font-size: 0.95rem; color: #555; margin-bottom: 1.5rem; }
  .featured-image { width: 100%; height: auto; border-radius: 8px; margin-top: 1rem; object-fit: cover; max-height: 400px; }
  hr { border: 0; border-top: 1px solid #eee; margin: 2rem 0; }
  .content { line-height: 1.8; color: #333; font-size: 1.05rem; }
  .content h2, .content h3 { color: #2c3e50; margin-top: 2rem; }
  .content p { margin-bottom: 1.5rem; }
  .content blockquote { border-left: 4px solid #3498db; margin: 0; padding-left: 1rem; color: #555; font-style: italic; background: #f9f9f9; padding: 1rem; }
  .reaction-zone { margin-top: 4rem; padding: 2rem; background: #f8f9fa; border-radius: 12px; text-align: center; border: 1px dashed #cbd5e0; }
  .reaction-zone h4 { margin: 0 0 1.5rem 0; color: #555; }
  .buttons-wrapper { display: flex; justify-content: center; align-items: center; gap: 15px; }
  .reaction-help { font-size: 0.8rem; color: #999; margin-top: 1rem; }
  :global(.comment-box) { margin-top: 3rem; background: #fff; padding: 0; border-top: 2px solid #f1f1f1; }
  :global(.comment-box h3) { margin-bottom: 1.5rem; font-size: 1.2rem; color: #333; }
  :global(.comment) { display: flex; gap: 15px; margin-bottom: 1.5rem; align-items: flex-start; }
  :global(.comment .avatar) { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #ecf0f1; background: white; object-fit: cover; }
  :global(.comment .bubble) { background: #f1f3f5; padding: 12px 18px; border-radius: 0 15px 15px 15px; position: relative; max-width: 80%; }
  :global(.comment .bubble strong) { display: block; font-size: 0.9rem; color: #2c3e50; margin-bottom: 4px; }
  :global(.comment .bubble p) { margin: 0; font-size: 0.95rem; color: #495057; line-height: 1.5; }
  @media (max-width: 600px) {
    .blog-post { padding: 1.5rem; }
    h1 { font-size: 1.8rem; }
    :global(.comment .bubble) { max-width: 100%; }
  }
</style>
