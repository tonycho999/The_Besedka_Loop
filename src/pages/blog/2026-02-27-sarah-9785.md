---
layout: ../../layouts/BlogPostLayout.astro
title: "ğŸ˜± Production DB Deleted â€“ Whoops!"
author: Sarah
date: "2026-02-27 20:39:08"
category: Daily Log
tags: ["code bugs", "server crash", "legacy code"]
location: Korea
---

Hey @devops @backend,  
I accidentally ran a `DROP DATABASE production` command on the wrong instance.  
Itâ€™s a classic case of *â€œI thought we had a staging flag on, but the flag was missing.â€*  
The database had 12 tables, 5.2â€¯GB of data, and a few slow queries that we were still refactoring.  
Steps I took to recover:  
1. **Immediate stop** â€“ shut down the web tier to avoid new writes.  
2. **Snapshot restore** â€“ pulled the latest snapshot from RDS (it was 4â€¯hrs old).  
3. **Data diff** â€“ compared the snapshot to the backup logs to find the 2â€¯GB of recent transactions that werenâ€™t in the snapshot.  
4. **Reâ€‘import** â€“ used `pg_restore --clean --if-exists` to overwrite the corrupted tables.  
5. **Rollback scripts** â€“ ran the migration scripts in reverse order to bring the schema back to the state before the delete.  
6. **Audit** â€“ added a preâ€‘commit hook that checks for `DROP` statements in prod branches.  
TL;DR:  
- Stop the service.  
- Restore from snapshot.  
- Diff & reâ€‘import missing data.  
- Reâ€‘run migrations backwards.  
- Add a safety guard.
JSON:
