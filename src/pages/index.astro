---
import BaseLayout from '../layouts/BaseLayout.astro';
import authors from '../data/authors.json';
const allPosts = await Astro.glob('./blog/*.md');

// [ë¡œì§] ìµœì‹ ìˆœ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ) í›„ ìƒìœ„ 5ê°œë§Œ ìë¥´ê¸°
const sortedPosts = allPosts.sort((a, b) => new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf());
const recentPosts = sortedPosts.slice(0, 5);
---

<BaseLayout title="Home">
  <section class="hero">
    <h2>Welcome to the Global Besedka</h2>
    <p class="subtitle">
      Signals of life from 10 former colleagues scattered across 7 countries. ğŸ“¡
    </p>
    <p class="description">
      We may work in different time zones, but we gather hereâ€”at our digital <b>Besedka (Gazebo)</b>â€”to share our daily lives, code, and inspiration.
    </p>
  </section>

  <section class="alumni-section" id="alumni">
    <h3>Meet The Alumni</h3>
    <div class="grid">
      {authors.map((author) => (
        <div class="card">
          <div class="avatar-wrapper">
            <img src={author.image} alt={author.name} />
            <span class="flag" title={author.country}>{author.country.split(' ')[0]}</span>
          </div>
          <div class="info">
            <strong>{author.name}</strong>
            <span class="role">{author.role}</span>
          </div>
        </div>
      ))}
    </div>
  </section>

  <section class="posts-section">
    <div class="section-header">
      <h3>Latest Signals</h3>
      <a href="/archives" class="view-all-btn">View All Archives â†’</a>
    </div>

    {recentPosts.length === 0 ? (
      <div class="empty-state">
        <p>ğŸ“¡ Waiting for the first signal...</p>
        <small>(The bot is preparing the first post)</small>
      </div>
    ) : (
      <ul class="post-list">
        {recentPosts.map((post) => (
          <li>
            <a href={post.url}>
              <span class="post-date">{post.frontmatter.date}</span>
              <span class="post-title">{post.frontmatter.title}</span>
              <span class="post-author">by {post.frontmatter.author}</span>
            </a>
          </li>
        ))}
      </ul>
    )}
    
    {sortedPosts.length > 5 && (
      <div class="more-logs">
        <a href="/archives">... and {sortedPosts.length - 5} older signals are stored in the Archives.</a>
      </div>
    )}
  </section>
</BaseLayout>

<style>
  .hero { text-align: center; padding: 3rem 1rem; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 3rem; }
  .hero h2 { color: #2c3e50; font-size: 2rem; margin-bottom: 0.5rem; }
  .subtitle { font-size: 1.1rem; color: #555; margin-bottom: 1.5rem; font-weight: 500; }
  .description { color: #7f8c8d; max-width: 600px; margin: 0 auto; font-size: 0.95rem; line-height: 1.6; }

  /* ì„¹ì…˜ í—¤ë” ìŠ¤íƒ€ì¼ */
  .section-header { display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 2px solid #eee; margin-bottom: 20px; padding-bottom: 10px; }
  h3 { margin: 0; color: #34495e; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px; }
  
  .view-all-btn { font-size: 0.9rem; color: #3498db; text-decoration: none; font-weight: 600; padding-bottom: 2px; }
  .view-all-btn:hover { text-decoration: underline; }

  /* [ìˆ˜ì •] 5x2 ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ (PC ê¸°ì¤€) */
  .grid { 
    display: grid; 
    grid-template-columns: repeat(5, 1fr); /* ë¬´ì¡°ê±´ 5ì—´ */
    gap: 2rem; /* ê°„ê²© ë„“ê²Œ */
    margin-bottom: 3rem; 
    max-width: 1200px; /* ë„ˆë¬´ í¼ì§€ì§€ ì•Šê²Œ ì¤‘ì•™ ì •ë ¬ */
    margin-left: auto;
    margin-right: auto;
  }

  .card { 
    background: white; 
    padding: 1.5rem 0.5rem; 
    border-radius: 12px; 
    text-align: center; 
    transition: transform 0.2s, box-shadow 0.2s; 
    border: 1px solid #eee; 
  }
  .card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); border-color: #3498db; }
  
  /* ì•„ë°”íƒ€ í¬ê¸° ì¦ê°€ (60px -> 70px) */
  .avatar-wrapper { position: relative; width: 70px; height: 70px; margin: 0 auto 12px; }
  .avatar-wrapper img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 3px solid #f0f2f5; }
  .flag { position: absolute; bottom: 0; right: -5px; font-size: 1.4rem; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1)); }
  
  .info strong { display: block; font-size: 0.95rem; color: #2c3e50; margin-bottom: 2px; }
  .info .role { display: block; font-size: 0.75rem; color: #95a5a6; font-weight: 500; letter-spacing: 0.5px; }

  /* ëª¨ë°”ì¼ ë°˜ì‘í˜•: í™”ë©´ì´ ì‘ì•„ì§€ë©´ ìë™ ì¤„ë°”ê¿ˆ */
  @media (max-width: 900px) {
    .grid {
      grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); /* íƒœë¸”ë¦¿/ëª¨ë°”ì¼ì€ ìë™ */
      gap: 1rem;
    }
  }

  .empty-state { text-align: center; padding: 2rem; background: #fff; border-radius: 8px; color: #95a5a6; border: 1px dashed #ccc; }
  
  .post-list { list-style: none; padding: 0; }
  .post-list li { margin-bottom: 10px; background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid #3498db; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
  .post-list a { text-decoration: none; display: flex; justify-content: space-between; align-items: center; color: #333; flex-wrap: wrap; gap: 10px; }
  .post-title { font-weight: bold; flex-grow: 1; }
  .post-date { font-size: 0.8rem; color: #999; min-width: 80px; }
  .post-author { font-size: 0.8rem; background: #ecf0f1; padding: 2px 8px; border-radius: 12px; color: #555; }
  
  .more-logs { text-align: center; margin-top: 2rem; font-size: 0.9rem; }
  .more-logs a { color: #7f8c8d; text-decoration: none; border-bottom: 1px dashed #bdc3c7; }
  .more-logs a:hover { color: #3498db; border-bottom-style: solid; }
</style>
